{
    "-- Refined SQL Template Metadata\n-- Refinement Time: 2025-07-22 03:04:51\n-- Operation: both\n-- Old Join Path: comp_cast_type (single table, no join)\n-- New Join Path: movie_info JOIN cast_info\n-- Table Size Changes: Switched from the very small table 'comp_cast_type' (24 kB, 4 rows) to joining 'movie_info' (1831 MB, 14,835,720 rows) and 'cast_info' (3881 MB, 36,244,344 rows) to increase the cost.\n-- Structural Changes: Rewrote the SQL to include a join between movie_info and cast_info; added aggregation with GROUP BY; introduced additional predicates including a BETWEEN filter for production_year, a threshold on cast_info.nr_order, and a filter on info_type_id. This increases the overall query complexity.\n-- LLM Reasoning: To reach the higher target cost, I moved away from the small comp_cast_type table and replaced it with a join between large tables (movie_info and cast_info), added aggregation and grouping, and introduced multiple filtering predicates. These structural and join path modifications are expected to significantly increase the execution plan cost into the range of [5000.0, 6000.0].\n\n-- SQL Template Metadata\n-- Template ID: 7\n-- Creation Time: 2025-07-22 02:58:48\n-- LLM Model: o3-mini\n-- Constraints:\n--   Number of unique Tables Accessed: 2\n--   Number of Joins: 1\n--   Number of Aggregations: 1\n--   Semantic Requirement: The query should use aggregation, and have at least three predicate values to fill.\n--   Tables Involved: ['movie_info', 'cast_info']\n-- Rewrite Attempts Number for Constraints Check: 2\n-- Rewrite Attempts Number for Grammar Check: 0\n\nSELECT mi.movie_id,\n       COUNT(DISTINCT c.id) AS cast_count,\n       MIN(mi.production_year) AS min_year,\n       MAX(mi.production_year) AS max_year,\n       AVG(mi.info_type_id) AS avg_info_type\nFROM movie_info mi\nJOIN cast_info c ON c.movie_id = mi.movie_id\nWHERE mi.production_year BETWEEN '{{movie_info.production_year_start}}' AND '{{movie_info.production_year_end}}'\n  AND c.nr_order >= '{{cast_info.nr_order_min}}'\n  AND mi.info_type_id = '{{movie_info.info_type}}'\nGROUP BY mi.movie_id;": []
}